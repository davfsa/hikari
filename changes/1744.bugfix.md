Ensure shard connect and disconnect always get sent in pairs and properly waited for
